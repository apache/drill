<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_232) on Tue Dec 24 19:09:35 EET 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MemoryAllocationUtilities (Apache Drill Root POM 1.17.0 API)</title>
<meta name="date" content="2019-12-24">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="MemoryAllocationUtilities (Apache Drill Root POM 1.17.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MemoryAllocationUtilities.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/drill/exec/util/JsonStringHashMap.html" title="class in org.apache.drill.exec.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/drill/exec/util/MiniZooKeeperCluster.html" title="class in org.apache.drill.exec.util"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/drill/exec/util/MemoryAllocationUtilities.html" target="_top">Frames</a></li>
<li><a href="MemoryAllocationUtilities.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.drill.exec.util</div>
<h2 title="Class MemoryAllocationUtilities" class="title">Class MemoryAllocationUtilities</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.drill.exec.util.MemoryAllocationUtilities</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">MemoryAllocationUtilities</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/drill/exec/util/MemoryAllocationUtilities.html#MemoryAllocationUtilities--">MemoryAllocationUtilities</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/drill/exec/util/MemoryAllocationUtilities.html#computeOperatorMemory-org.apache.drill.exec.server.options.OptionSet-long-int-">computeOperatorMemory</a></span>(<a href="../../../../../org/apache/drill/exec/server/options/OptionSet.html" title="interface in org.apache.drill.exec.server.options">OptionSet</a>&nbsp;optionManager,
                     long&nbsp;maxAllocPerNode,
                     int&nbsp;opCount)</code>
<div class="block">Compute per-operator memory based on the computed per-node memory, the
 number of operators, and the computed number of fragments (which house
 the operators.) Enforces a floor on the amount of memory per operator.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/drill/exec/util/MemoryAllocationUtilities.html#computeQueryMemory-org.apache.drill.common.config.DrillConfig-org.apache.drill.exec.server.options.OptionSet-long-">computeQueryMemory</a></span>(<a href="../../../../../org/apache/drill/common/config/DrillConfig.html" title="class in org.apache.drill.common.config">DrillConfig</a>&nbsp;config,
                  <a href="../../../../../org/apache/drill/exec/server/options/OptionSet.html" title="interface in org.apache.drill.exec.server.options">OptionSet</a>&nbsp;optionManager,
                  long&nbsp;directMemory)</code>
<div class="block">Per-node memory calculations based on a number of constraints.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../org/apache/drill/exec/physical/base/PhysicalOperator.html" title="interface in org.apache.drill.exec.physical.base">PhysicalOperator</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/drill/exec/util/MemoryAllocationUtilities.html#getBufferedOperators-java.util.List-org.apache.drill.exec.ops.QueryContext-">getBufferedOperators</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../org/apache/drill/exec/physical/base/PhysicalOperator.html" title="interface in org.apache.drill.exec.physical.base">PhysicalOperator</a>&gt;&nbsp;operators,
                    <a href="../../../../../org/apache/drill/exec/ops/QueryContext.html" title="class in org.apache.drill.exec.ops">QueryContext</a>&nbsp;queryContext)</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/drill/exec/util/MemoryAllocationUtilities.html#setupBufferedMemoryAllocations-org.apache.drill.exec.physical.PhysicalPlan-org.apache.drill.exec.ops.QueryContext-">setupBufferedMemoryAllocations</a></span>(<a href="../../../../../org/apache/drill/exec/physical/PhysicalPlan.html" title="class in org.apache.drill.exec.physical">PhysicalPlan</a>&nbsp;plan,
                              <a href="../../../../../org/apache/drill/exec/ops/QueryContext.html" title="class in org.apache.drill.exec.ops">QueryContext</a>&nbsp;queryContext)</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/drill/exec/util/MemoryAllocationUtilities.html#setupBufferedOpsMemoryAllocations-boolean-java.util.List-org.apache.drill.exec.ops.QueryContext-">setupBufferedOpsMemoryAllocations</a></span>(boolean&nbsp;planHasMemory,
                                 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../org/apache/drill/exec/physical/base/PhysicalOperator.html" title="interface in org.apache.drill.exec.physical.base">PhysicalOperator</a>&gt;&nbsp;bufferedOperators,
                                 <a href="../../../../../org/apache/drill/exec/ops/QueryContext.html" title="class in org.apache.drill.exec.ops">QueryContext</a>&nbsp;queryContext)</code>
<div class="block">Helper method to setup Memory Allocations</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MemoryAllocationUtilities--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MemoryAllocationUtilities</h4>
<pre>public&nbsp;MemoryAllocationUtilities()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setupBufferedMemoryAllocations-org.apache.drill.exec.physical.PhysicalPlan-org.apache.drill.exec.ops.QueryContext-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupBufferedMemoryAllocations</h4>
<pre>public static&nbsp;void&nbsp;setupBufferedMemoryAllocations(<a href="../../../../../org/apache/drill/exec/physical/PhysicalPlan.html" title="class in org.apache.drill.exec.physical">PhysicalPlan</a>&nbsp;plan,
                                                  <a href="../../../../../org/apache/drill/exec/ops/QueryContext.html" title="class in org.apache.drill.exec.ops">QueryContext</a>&nbsp;queryContext)</pre>
</li>
</ul>
<a name="getBufferedOperators-java.util.List-org.apache.drill.exec.ops.QueryContext-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBufferedOperators</h4>
<pre>public static&nbsp;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../org/apache/drill/exec/physical/base/PhysicalOperator.html" title="interface in org.apache.drill.exec.physical.base">PhysicalOperator</a>&gt;&nbsp;getBufferedOperators(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../org/apache/drill/exec/physical/base/PhysicalOperator.html" title="interface in org.apache.drill.exec.physical.base">PhysicalOperator</a>&gt;&nbsp;operators,
                                                          <a href="../../../../../org/apache/drill/exec/ops/QueryContext.html" title="class in org.apache.drill.exec.ops">QueryContext</a>&nbsp;queryContext)</pre>
</li>
</ul>
<a name="setupBufferedOpsMemoryAllocations-boolean-java.util.List-org.apache.drill.exec.ops.QueryContext-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupBufferedOpsMemoryAllocations</h4>
<pre>public static&nbsp;void&nbsp;setupBufferedOpsMemoryAllocations(boolean&nbsp;planHasMemory,
                                                     <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../org/apache/drill/exec/physical/base/PhysicalOperator.html" title="interface in org.apache.drill.exec.physical.base">PhysicalOperator</a>&gt;&nbsp;bufferedOperators,
                                                     <a href="../../../../../org/apache/drill/exec/ops/QueryContext.html" title="class in org.apache.drill.exec.ops">QueryContext</a>&nbsp;queryContext)</pre>
<div class="block">Helper method to setup Memory Allocations
 <p>
 Plan the memory for buffered operators (the only ones that can spill in this release)
 based on assumptions. These assumptions are the amount of memory per node to give
 to each query and the number of sort operators per node.
 <p>
 The reason the total
 memory is an assumption is that we have know knowledge of the number of queries
 that can run, so we need the user to tell use that information by configuring the
 amount of memory to be assumed available to each query.
 <p>
 The number of sorts per node could be calculated, but we instead simply take
 the worst case: the maximum per-query, per-node parallization and assume that
 all sorts appear in all fragments &mdash; a gross oversimplification, but one
 that Drill has long made.
 <p>
 since this method can be used in multiple places adding it in this class
 rather than keeping it in Foreman</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>planHasMemory</code> - defines the memory planning needs to be done or not.
                             generally skipped when the plan contains memory allocation.</dd>
<dd><code>bufferedOperators</code> - list of buffered operators in the plan.</dd>
<dd><code>queryContext</code> - context of the query.</dd>
</dl>
</li>
</ul>
<a name="computeOperatorMemory-org.apache.drill.exec.server.options.OptionSet-long-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeOperatorMemory</h4>
<pre>public static&nbsp;long&nbsp;computeOperatorMemory(<a href="../../../../../org/apache/drill/exec/server/options/OptionSet.html" title="interface in org.apache.drill.exec.server.options">OptionSet</a>&nbsp;optionManager,
                                         long&nbsp;maxAllocPerNode,
                                         int&nbsp;opCount)</pre>
<div class="block">Compute per-operator memory based on the computed per-node memory, the
 number of operators, and the computed number of fragments (which house
 the operators.) Enforces a floor on the amount of memory per operator.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>optionManager</code> - system option manager</dd>
<dd><code>maxAllocPerNode</code> - computed query memory per node</dd>
<dd><code>opCount</code> - number of buffering operators in this query</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the per-operator memory</dd>
</dl>
</li>
</ul>
<a name="computeQueryMemory-org.apache.drill.common.config.DrillConfig-org.apache.drill.exec.server.options.OptionSet-long-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>computeQueryMemory</h4>
<pre>public static&nbsp;long&nbsp;computeQueryMemory(<a href="../../../../../org/apache/drill/common/config/DrillConfig.html" title="class in org.apache.drill.common.config">DrillConfig</a>&nbsp;config,
                                      <a href="../../../../../org/apache/drill/exec/server/options/OptionSet.html" title="interface in org.apache.drill.exec.server.options">OptionSet</a>&nbsp;optionManager,
                                      long&nbsp;directMemory)</pre>
<div class="block">Per-node memory calculations based on a number of constraints.
 <p>
 Factored out into a separate method to allow unit testing.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>config</code> - Drill config</dd>
<dd><code>optionManager</code> - system options</dd>
<dd><code>directMemory</code> - amount of direct memory</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>memory per query per node</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MemoryAllocationUtilities.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/drill/exec/util/JsonStringHashMap.html" title="class in org.apache.drill.exec.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/drill/exec/util/MiniZooKeeperCluster.html" title="class in org.apache.drill.exec.util"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/drill/exec/util/MemoryAllocationUtilities.html" target="_top">Frames</a></li>
<li><a href="MemoryAllocationUtilities.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2019 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</body>
</html>
