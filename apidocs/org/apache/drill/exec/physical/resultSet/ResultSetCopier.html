<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_232) on Tue Dec 24 19:10:05 EET 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ResultSetCopier (Apache Drill Root POM 1.17.0 API)</title>
<meta name="date" content="2019-12-24">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ResultSetCopier (Apache Drill Root POM 1.17.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ResultSetCopier.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ProjectionSet.ColumnReadProjection.html" title="interface in org.apache.drill.exec.physical.resultSet"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetLoader.html" title="interface in org.apache.drill.exec.physical.resultSet"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/drill/exec/physical/resultSet/ResultSetCopier.html" target="_top">Frames</a></li>
<li><a href="ResultSetCopier.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.drill.exec.physical.resultSet</div>
<h2 title="Interface ResultSetCopier" class="title">Interface ResultSetCopier</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../../org/apache/drill/exec/physical/resultSet/impl/ResultSetCopierImpl.html" title="class in org.apache.drill.exec.physical.resultSet.impl">ResultSetCopierImpl</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">ResultSetCopier</span></pre>
<div class="block">Copies rows from an input batch to an output batch. The input
 batch is assumed to have a selection vector, or the caller
 will pick the rows to copy.
 <p>
 Works to create full output batches to minimize per-batch
 overhead and to eliminate unnecessary empty batches if no
 rows are copied.
 <p>
 The output batches are assumed to have the same schema as
 input batches. (No projection occurs.) The output schema will
 change each time the input schema changes. (For an SV4, then
 the upstream operator must have ensured all batches covered
 by the SV4 have the same schema.)
 <p>
 This implementation works with a single stream of batches which,
 following Drill's rules, must consist of the same set of vectors on
 each non-schema-change batch.

 <h4>Protocol</h4>
 Overall lifecycle:
 <ol>
 <li>Create an instance of the
     <a href="../../../../../../org/apache/drill/exec/physical/resultSet/impl/ResultSetCopierImpl.html" title="class in org.apache.drill.exec.physical.resultSet.impl"><code>ResultSetCopierImpl</code></a> class, passing the input batch
      accessor to the constructor.</li>
 <li>Loop to process each output batch as shown below. That is, continually
     process calls to the <a href="../../../../../../org/apache/drill/exec/physical/impl/aggregate/BatchIterator.html#next--"><code>BatchIterator.next()</code></a> method.</li>
 <li>Call <a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#close--"><code>close()</code></a>.</li>
 </ol>
 <p>

 To build each output batch:

 <pre><code>
 public IterOutcome next() {
   copier.startOutputBatch();
   while (! copier.isFull() {
     copier.freeInput();
     IterOutcome innerResult = inner.next();
     if (innerResult == DONE) { break; }
     copier.startInputBatch();
     copier.copyAllRows();
   }
   if (copier.hasRows()) {
     outputContainer = copier.harvest();
     return outputContainer.isSchemaChanged() ? OK_NEW_SCHEMA ? OK;
   } else { return DONE; }
 }
 </code></pre>
 <p>
 The above assumes that the upstream operator can be polled
 multiple times in the DONE state. The extra polling is
 needed to handle any in-flight copies when the input
 exhausts its batches.
 <p>
 The above also shows that the copier handles and reports
 schema changes by setting the schema change flag in the
 output container. Real code must handle multiple calls to
 next() in the DONE state, and work around lack of such support
 in its input (perhaps by tracking a state.)
 <p>
 An input batch is processed by copying the rows. Copying can be done
 row-by row, via a row range, or by copying the entire input batch as
 shown in the example.
 Copying the entire batch make sense when the input batch carries as
 selection vector that identifies which rows to copy, in which
 order.
 <p>
 Because we wish to fill the output batch, we may be able to copy
 part of a batch, the whole batch, or multiple batches to the output.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#close--">close</a></span>()</code>
<div class="block">Release resources, including any pending input batch
 and any non-harvested output batch.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#copyAllRows--">copyAllRows</a></span>()</code>
<div class="block">Copy all (remaining) input rows to the output.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#copyNextRow--">copyNextRow</a></span>()</code>
<div class="block">If copying rows one by one, copy the next row from the
 input.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#copyRow-int-">copyRow</a></span>(int&nbsp;inputRowIndex)</code>
<div class="block">Copy a row at the given position.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/drill/exec/record/VectorContainer.html" title="class in org.apache.drill.exec.record">VectorContainer</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#harvest--">harvest</a></span>()</code>
<div class="block">Obtain the output batch.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#hasOutputRows--">hasOutputRows</a></span>()</code>
<div class="block">Reports if the output batch has rows.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#isCopyPending--">isCopyPending</a></span>()</code>
<div class="block">Helper method to determine if a copy is pending: more rows
 remain to be copied.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#isOutputFull--">isOutputFull</a></span>()</code>
<div class="block">Reports if the output batch is full and must be sent
 downstream.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#releaseInputBatch--">releaseInputBatch</a></span>()</code>
<div class="block">Release the input.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#startInputBatch--">startInputBatch</a></span>()</code>
<div class="block">Start the next input batch.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#startOutputBatch--">startOutputBatch</a></span>()</code>
<div class="block">Start the next output batch.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="startOutputBatch--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startOutputBatch</h4>
<pre>void&nbsp;startOutputBatch()</pre>
<div class="block">Start the next output batch.</div>
</li>
</ul>
<a name="startInputBatch--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startInputBatch</h4>
<pre>void&nbsp;startInputBatch()</pre>
<div class="block">Start the next input batch. The input batch must be held
 by the VectorAccessor passed into the constructor.</div>
</li>
</ul>
<a name="copyNextRow--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyNextRow</h4>
<pre>boolean&nbsp;copyNextRow()</pre>
<div class="block">If copying rows one by one, copy the next row from the
 input.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if more rows remain on the input, false
 if all rows are exhausted</dd>
</dl>
</li>
</ul>
<a name="copyRow-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyRow</h4>
<pre>void&nbsp;copyRow(int&nbsp;inputRowIndex)</pre>
<div class="block">Copy a row at the given position. For those cases in
 which random copying is needed, but a selection vector
 is not available. Note that this version is slow because
 of the need to reset indexes for every row. Better to
 use a selection vector, then copy sequentially.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>inputRowIndex</code> - the input row position. If a selection vector
 is attached, then this is the selection vector position</dd>
</dl>
</li>
</ul>
<a name="copyAllRows--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyAllRows</h4>
<pre>void&nbsp;copyAllRows()</pre>
<div class="block">Copy all (remaining) input rows to the output.
 If insufficient space exists in the output, does a partial
 copy, and <a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#isCopyPending--"><code>isCopyPending()</code></a> will return true.</div>
</li>
</ul>
<a name="releaseInputBatch--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseInputBatch</h4>
<pre>void&nbsp;releaseInputBatch()</pre>
<div class="block">Release the input. Must be called (explicitly, or via
 <code>#copyInput()</code> before loading another input batch.</div>
</li>
</ul>
<a name="hasOutputRows--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasOutputRows</h4>
<pre>boolean&nbsp;hasOutputRows()</pre>
<div class="block">Reports if the output batch has rows. Useful after the end
 of input to determine if a partial output batch exists to
 send downstream.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the output batch has one or more rows</dd>
</dl>
</li>
</ul>
<a name="isOutputFull--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isOutputFull</h4>
<pre>boolean&nbsp;isOutputFull()</pre>
<div class="block">Reports if the output batch is full and must be sent
 downstream. The output batch can be full in the middle
 of a copy, in which case <a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetCopier.html#isCopyPending--"><code>isCopyPending()</code></a> will
 also return true.
 <p>
 This function also returns true if a schema change
 occurred on the latest input row, in which case the
 partially-completed batch of the old schema must be
 flushed downstream.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the output is full and must be harvested
 and sent downstream</dd>
</dl>
</li>
</ul>
<a name="isCopyPending--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isCopyPending</h4>
<pre>boolean&nbsp;isCopyPending()</pre>
<div class="block">Helper method to determine if a copy is pending: more rows
 remain to be copied. If so, start a new output batch, which
 will finish the copy. Do that before start a new input
 batch.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a name="harvest--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>harvest</h4>
<pre><a href="../../../../../../org/apache/drill/exec/record/VectorContainer.html" title="class in org.apache.drill.exec.record">VectorContainer</a>&nbsp;harvest()</pre>
<div class="block">Obtain the output batch. Returned as a vector container
 since the output will not have a selection vector.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a vector container holding the output batch</dd>
</dl>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>close</h4>
<pre>void&nbsp;close()</pre>
<div class="block">Release resources, including any pending input batch
 and any non-harvested output batch.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ResultSetCopier.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ProjectionSet.ColumnReadProjection.html" title="interface in org.apache.drill.exec.physical.resultSet"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/drill/exec/physical/resultSet/ResultSetLoader.html" title="interface in org.apache.drill.exec.physical.resultSet"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/drill/exec/physical/resultSet/ResultSetCopier.html" target="_top">Frames</a></li>
<li><a href="ResultSetCopier.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2019 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</body>
</html>
